# Outlook NTLM Leak Lab (CVE-2023-23397)

This lab reproduces the behaviour exploited by CVE-2023-23397 where Outlook
processes meeting invites that reference remote UNC paths, leaking NTLM
credentials.

## Components

- **listener** – SMB capture server (Impacket `SimpleSMBServer`) that records
  authentication attempts under `/artifacts`.
- **attacker** – Generates malicious `.ics` invite files pointing at the
  listener.

## Usage

```bash
python ../../lab_manager.py prepare outlook-ntlm-leak --dry-run   # view commands
python ../../lab_manager.py prepare outlook-ntlm-leak              # build & start containers
```

Malicious invites are stored in `artifacts/meeting.ics`.  Distribute the file to
an Outlook client; when the invite is processed the client will attempt to reach
`\\ntlm-listener\share`, leaking NTLM credentials to the listener container.
Captured hashes appear in `/artifacts/SMBv2-NTLMv2-Client-*.txt`.

Tear down the lab when finished:

```bash
python ../../lab_manager.py destroy outlook-ntlm-leak
```

## Notes

- Import the generated certificate from the listener container into your hash
  cracking workflow as needed.
- This lab is for defensive research—never expose it to production networks.
